# Machine Learning Model
When it comes to determining whether one should consider purchasing a specific stock at their initial public offering, the anticipation of selling that stock at a higher price vs. the price they had bought it is the primary goal. 

We can observe this through the stock's return, which is the selling price per stock minus the price the stock was bought at. So in deciding on our target for our Model, we decided that the **stock price return** would be our target, and using financial metrics that would influence a stock's return would be our features. 

# Feature Engineering and Feature Selection

## Target Selection

While our primary target is the stock price return, we decided to explore two specific features of the IPO's in our dataset:

1. Three Month Return
    -  IPO's may have conditions set where there is a period of time at which an IPO's shares are prohibited from being sold until a pre-specified time had passed. 
    - Typically this pre-specified 'IPO Lock-up' ranges from 90 to 120 days, so observing the stock's price after three months allows us to see its performance when the stock can be sold.
2. First Day Closing Price
    - During an IPO, a large increase between the initial offer price and price of the stock at the end of the first day is labeled as the 'IPO pop'.
    - Some may attribute the first day IPO pop as an indicator of success and demand for that stock.

## Feature Selection 
-  Potential features we decided to include and test since these are relevant Key Performance Indicators (KPIs)/ Business metrics to determine company performance which could influence a company's **stock price**. Our features can fall under 4 main categories:
    ### 1. Categorical Features:
   - The market’s receptiveness of each IPO will never be the same each issuance. We believe that it will differ largely based on the Sector and Industry of the company.

        | Feature | Description | 
        | :--- |:--- |
        | **Industry**| It refers to a part of the economy in which a great number of companies can be categorized and is larger in comparison to “Industry”. | 
        | **Sector**| It refers to a series of companies that operate in a similar business sphere, and its categorization is more narrow.    
    
    ### 2. Financial Health:
    - We believe that the market would also take into consideration of the company’s indebtedness and liquidity.

        | Feature | Description | 
        | :--- | :--- |
        | **Debt Asset Ratio**| A leverage ratio that defines the total amount of debt relative to assets owned by the company.|
        |**Current Ratio**| A liquidity metric that measures the company's ability to pay off its short term financial obligations in one year|
    - Debt-to-Asset Ratio
        - For shareholders, this is a good indicator of where a company's assets are held. Whether the bulk of assets are financed by the shareholders vs. creditors
    - Debt-to-equity Ratio
    - Current Ratio
        - This is a financial KPI that measure the company's ability to pay off its short term financial obligations in one year.
    - Operating Cash Flow Ratio

    ### 3. Operational Performance:
    - We believe that the market’s receptiveness of an IPO would be directly related to how well the company is performing. Specifically, it should be tied to a company’s profitability on different levels (gross, net, and earnings before accounting & financial deductions), as well as its ability to generate sufficient cash flow to maintain and grow its operations.

        | Feature | Description | 
        | :--- |:--- |
        | **EBITDA** | Earnings before interest, taxes, depreciation, and amortization, is a measure of a company's overall financial performance before the influence of accounting and financial deductions.  |
        | **Gross Profit Margin** | A measure of profitability that shows the percentage of revenue that exceeds the cost of goods sold. |
        | **Net Profit Margin**| It is the percentage of sales remaining after all expenses, interest, taxes and preferred stock dividends have been deducted from total revenue. |
        | **Operating Cash Flow** | It is a measure of the amount of cash generated by a company's normal business operations. It indicates whether a company can generate sufficient positive cash flow to maintain and grow its operations. | 
    - EBITDA
    - EBIT Margin
        - EBIT/Revenue
        - revenue you're generating how much EBIT you're getting
    - Net Profit Margin
		- This is the percentage of total profit over total sales made by the company. It is the percentage of sales remaining after all expenses, interest, taxes and preferred stock dividends have been deducted from total revenue
        - Indicates the company's ability to bring money from its regular operations
	- Gross Profit Margin
	    - This metric is especially important for starting companies as it reflects on improved processes and production
    ### 4. Long-term Planning
    - The market should also take into account of the company’s plan for the future. R&D and Cash Flow from Investment are good proxies that reflect the company’s willingness and preparedness for facing future challenges.

        | Feature | Description | 
        | :--- |:--- |
        **Research & Development (R&D)**| This is the amount of expenses in which the company devotes into developing or enhancing new products and services.|
        | **Cash Flow from Investments**| How much cash has been generated or spent from various investment-related activities in a specific period. Investing activities include purchases of physical assets, investments in R&D, investments in securities, or the sale of securities or assets.| 


## Feature Selection between Three Month and First Day Returns

While the above shows all of the features selected, our two models had their own set select features:

<img src="images/feature_differences.png"><img/>

With the primary difference of EBIT margin being used in our First Day Return model, while EBITDA and Research & Development proved more beneficial to the Three Month Return model

## Feature Importance

To find which features were most impactful on our models, we implemented Permuation Importance on our features used - which displays features and their weights on our models.

### Feature Importance on Three Month Return:
<img src="images/feature_weight_three_mth.png"></img>

With three month return as our target, Net Profit Margin was the most important feature for its model

### Feature Importance on First Day Closing Price:
<img src="images/feature_weight_first_day.png"></img>

But for our First Day Closing Price model, Gross Profit Margin, Cashflow from Investments and Operating Cashflow Ratio looked to be much more impactful.

# Preliminary Data Preprocessing


- To convert our categorical variable data into indicator variables of 0 or 1, we used panda's .get_dummies
- Preprocessing on our calculated columns which serve as our selected features such as Debt-to-Asset ratio and Net Profit Margin, had to be done before they could be introduced into our model.
    - any N/A's, or infinite values had to be removed




# Model Choices

## Training/Testing Split

- During Training/Testing our models, the highest accuracy found for both Three Month Return and First Day Closing Price was found when using a 67% training and 33% testing split

## Model Selection

- Since we have labeled data, we've tried using a variety of different binary classification models:
    - Logistic Regression (First Day Return)
<img src="images/log_first_day.png"></img>
    - Logistic Regression (Three Month Return)
<img src="images/log_three_mth.png"></img>
    - Random Forest (First Day Return)
    <img src="images/random.png"></img>
    - Random Forest (Three Month Return)
    <img src="images/random_three_mth.png"></img>

- But our most successful results so far were found using **Deep Learning**
    - using all our 10 features, our models performed:
        - ~65% accuracy - Three Month Return model
        <img src="images/three_mth_model.png"></img>
        - ~60% accuracy - First Day Closing Price model
        <img src="images/first_day_model.png"></img>

## Attempts at Model Optimization

In attempts to optimize our model and achieve higher accuracy, the models were observed as features were added/removed. 

## Loss function
<img src="images/loss_first_day.png"></img>
<img src="images/loss_first_day.png"></img>
## Overfitting

Though modeling with Deep Learning allows it to handle many features, it is prone to overfitting. Our first attempts resulted in high training accuracy while our testing set would be low.

To counter-act overfitting, we reduced our neuron count from 2x our input features to 1.5. We also removed a hidden layer:
   <img src="images/overfit_example.png"></img>

Doing this resulted in our 65% and 60% accuracy on our three day return and first day close models respectively.

# To be attempted
- Explore sector specific features
    - there are many different features at which people would value certain companies more depending on the specific 
    - different businesses have could have different emphasis on different metrics
    - ie. manufacturing KPI vs merchandising KPI

# Conclusions

How does this model benefit anyone?
Does the model answer whether one should invest in an IPO?

If the model was given the same parameters 
